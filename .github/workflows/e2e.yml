# This is a basic workflow which starts end-to-end tests on GitHub actions
name: e2e

# Controls when the workflow will run
on:
  push:
    branches:
      - master

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  e2e:
    runs-on: ubuntu-latest

    steps:
      # Checks-out your repository under $GITHUB_WORKSPACE
      - name: Checkout
        uses: actions/checkout@v3

      # Runs a set of commands: using the runners shell
      - name: Run e2e tests via docker-compose
        timeout-minutes: 10
        run: docker compose -f docker-compose.yml up --scale chrome=3
        working-directory: .

      - name: Upload e2e test result as artifact on GitHub
        uses: actions/upload-artifact@v3
        with:
          name: e2e_reports
          path: ./build/reports/tests/e2e/e2e/